<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate AI Assistant - Complete Version</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        body { 
            margin: 0; 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif; 
            overflow: hidden;
        }
        .code-block {
            background: #1a1a1a;
            border-radius: 8px;
            padding: 16px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            overflow-x: auto;
            color: #e5e5e5;
        }
        .syntax-keyword { color: #569cd6; }
        .syntax-string { color: #ce9178; }
        .syntax-comment { color: #6a9955; }
        .syntax-function { color: #dcdcaa; }
        .agent-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        .search-highlight {
            background: linear-gradient(45deg, #3b82f6, #8b5cf6);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .model-indicator {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        .analytics-chart {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
        }
        .progress-bar {
            background: linear-gradient(90deg, #3b82f6, #8b5cf6, #06b6d4);
            background-size: 200% 100%;
            animation: gradient-flow 2s ease-in-out infinite;
        }
        @keyframes gradient-flow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        .glass-panel {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(148, 163, 184, 0.1);
        }
        .neon-glow {
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo, useCallback } = React;
        const { 
            Search, Code, Filter, Send, Copy, Check, ExternalLink, Star, Clock, User, Tag, Brain, Zap, TrendingUp, 
            BookOpen, Settings, Cpu, Database, Globe, Shield, Workflow, GitBranch, Terminal, FileCode, 
            Layers, Network, Bot, Lightbulb, Target, BarChart3, MessageCircle, Image, Mic, Video,
            CloudUpload, Download, Share, Bookmark, History, Palette, Sparkles, Rocket, Crown,
            AlertTriangle, Info, CheckCircle, Play, Pause, RotateCcw, Activity, Eye, Wrench,
            Monitor, Gauge, PieChart, LineChart, ArrowUp, ArrowDown, Percent, Menu, X, ThumbsUp, ThumbsDown
        } = lucide;

        const UltimateAIAssistant = () => {
            // === CORE STATE MANAGEMENT ===
            const [messages, setMessages] = useState([]);
            const [input, setInput] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const [isThinking, setIsThinking] = useState(false);
            const [isLearning, setIsLearning] = useState(false);
            const [isProcessing, setIsProcessing] = useState(false);
            
            // === UI PANEL STATES ===
            const [showFilters, setShowFilters] = useState(false);
            const [showAgentPanel, setShowAgentPanel] = useState(false);
            const [showAnalytics, setShowAnalytics] = useState(false);
            const [showCodePanel, setShowCodePanel] = useState(false);
            const [workspaceMode, setWorkspaceMode] = useState('coding');
            
            // === MODEL AND AGENT STATES ===
            const [selectedModel, setSelectedModel] = useState('gpt-4-turbo');
            const [selectedModels, setSelectedModels] = useState(['gpt-4-turbo']);
            const [activeAgents, setActiveAgents] = useState(['searchAgent']);
            
            // === RESULT STATES ===
            const [searchResults, setSearchResults] = useState([]);
            const [codeExecutionResults, setCodeExecutionResults] = useState([]);
            const [agentLogs, setAgentLogs] = useState([]);
            const [processingLogs, setProcessingLogs] = useState([]);
            const [modelPerformance, setModelPerformance] = useState({});
            
            // === REFS ===
            const messagesEndRef = useRef(null);

            // === AI MODELS CONFIGURATION ===
            const [aiModels, setAiModels] = useState({
                'gpt-4-turbo': { 
                    name: 'GPT-4 Turbo', 
                    strength: 'Reasoning & Code', 
                    icon: 'üß†', 
                    active: true,
                    processing: false,
                    confidence: 0.92,
                    speed: 0.85,
                    cost: 0.03,
                    specialty: ['coding', 'reasoning', 'analysis'],
                    description: 'Advanced reasoning and code generation with superior problem-solving capabilities'
                },
                'claude-3-opus': { 
                    name: 'Claude 3 Opus', 
                    strength: 'Analysis & Writing', 
                    icon: 'üìù', 
                    active: false,
                    processing: false,
                    confidence: 0.89,
                    speed: 0.78,
                    cost: 0.025,
                    specialty: ['writing', 'analysis', 'research'],
                    description: 'Exceptional analytical writing and comprehensive research capabilities'
                },
                'gemini-ultra': { 
                    name: 'Gemini Ultra', 
                    strength: 'Multimodal & Research', 
                    icon: 'üîç', 
                    active: false,
                    processing: false,
                    confidence: 0.87,
                    speed: 0.82,
                    cost: 0.02,
                    specialty: ['research', 'multimodal', 'search'],
                    description: 'Multimodal processing with advanced research and information synthesis'
                },
                'codex': { 
                    name: 'GitHub Codex', 
                    strength: 'Code Generation', 
                    icon: 'üíª', 
                    active: false,
                    processing: false,
                    confidence: 0.94,
                    speed: 0.91,
                    cost: 0.015,
                    specialty: ['coding', 'debugging', 'optimization'],
                    description: 'Specialized code generation with deep understanding of programming languages'
                },
                'dall-e-3': { 
                    name: 'DALL-E 3', 
                    strength: 'Image Generation', 
                    icon: 'üé®', 
                    active: false,
                    processing: false,
                    confidence: 0.88,
                    speed: 0.65,
                    cost: 0.04,
                    specialty: ['images', 'design', 'visual'],
                    description: 'Advanced image generation with artistic coherence and creative vision'
                },
                'whisper': { 
                    name: 'Whisper', 
                    strength: 'Speech Recognition', 
                    icon: 'üé§', 
                    active: false,
                    processing: false,
                    confidence: 0.96,
                    speed: 0.89,
                    cost: 0.006,
                    specialty: ['audio', 'transcription', 'voice'],
                    description: 'High-accuracy speech recognition and audio processing'
                },
                'local-llama': { 
                    name: 'Local Llama 2', 
                    strength: 'Privacy & Speed', 
                    icon: 'ü¶ô', 
                    active: false,
                    processing: false,
                    confidence: 0.82,
                    speed: 0.95,
                    cost: 0,
                    specialty: ['privacy', 'local', 'fast'],
                    description: 'Local processing for privacy-focused applications with fast response times'
                }
            });

            // === AUTONOMOUS AGENTS CONFIGURATION ===
            const [autonomousAgents, setAutonomousAgents] = useState({
                codeReviewer: {
                    name: 'Code Reviewer',
                    description: 'Reviews code for best practices, security, and performance',
                    active: false,
                    confidence: 0.89,
                    status: 'idle',
                    icon: Eye,
                    color: 'blue',
                    lastRun: null,
                    totalRuns: 0
                },
                testGenerator: {
                    name: 'Test Generator',
                    description: 'Creates comprehensive test suites for your code',
                    active: false,
                    confidence: 0.92,
                    status: 'idle',
                    icon: CheckCircle,
                    color: 'green',
                    lastRun: null,
                    totalRuns: 0
                },
                securityAnalyst: {
                    name: 'Security Analyst',
                    description: 'Scans for vulnerabilities and security issues',
                    active: false,
                    confidence: 0.94,
                    status: 'idle',
                    icon: Shield,
                    color: 'red',
                    lastRun: null,
                    totalRuns: 0
                },
                optimizationEngine: {
                    name: 'Optimization Engine',
                    description: 'Optimizes code performance and resource usage',
                    active: false,
                    confidence: 0.88,
                    status: 'idle',
                    icon: Zap,
                    color: 'yellow',
                    lastRun: null,
                    totalRuns: 0
                },
                documentationBot: {
                    name: 'Documentation Bot',
                    description: 'Generates and maintains project documentation',
                    active: false,
                    confidence: 0.85,
                    status: 'idle',
                    icon: BookOpen,
                    color: 'purple',
                    lastRun: null,
                    totalRuns: 0
                },
                deploymentManager: {
                    name: 'Deployment Manager',
                    description: 'Handles CI/CD, containerization, and cloud deployment',
                    active: false,
                    confidence: 0.87,
                    status: 'idle',
                    icon: Rocket,
                    color: 'orange',
                    lastRun: null,
                    totalRuns: 0
                },
                searchAgent: {
                    name: 'Smart Search Agent',
                    description: 'Performs intelligent web searches and analysis',
                    active: true,
                    confidence: 0.91,
                    status: 'active',
                    icon: Search,
                    color: 'cyan',
                    lastRun: null,
                    totalRuns: 0
                },
                apiDesigner: {
                    name: 'API Designer',
                    description: 'Designs and generates RESTful APIs and GraphQL schemas',
                    active: false,
                    confidence: 0.91,
                    status: 'idle',
                    icon: Network,
                    color: 'indigo',
                    lastRun: null,
                    totalRuns: 0
                }
            });

            // === WORKSPACE MODES ===
            const workspaceModes = {
                coding: { icon: Code, color: 'bg-blue-600', label: 'Coding' },
                research: { icon: Search, color: 'bg-green-600', label: 'Research' },
                design: { icon: Palette, color: 'bg-purple-600', label: 'Design' },
                deployment: { icon: Rocket, color: 'bg-red-600', label: 'Deployment' },
                analysis: { icon: BarChart3, color: 'bg-yellow-600', label: 'Analysis' },
                collaboration: { icon: MessageCircle, color: 'bg-pink-600', label: 'Collaboration' },
                testing: { icon: CheckCircle, color: 'bg-teal-600', label: 'Testing' },
                security: { icon: Shield, color: 'bg-orange-600', label: 'Security' }
            };
// === AUTO MODE CONFIGURATION ===
            const [autoMode, setAutoMode] = useState({
                codeGeneration: true,
                testing: true,
                optimization: true,
                documentation: true,
                deployment: false,
                security: true,
                search: true,
                multiModel: true
            });

            // === SEARCH FILTERS ===
            const [filters, setFilters] = useState({
                language: '',
                framework: '',
                source: '',
                recency: 'all',
                difficulty: 'all',
                aiModel: 'auto',
                includeCode: true,
                includeDocumentation: true,
                includeExamples: true
            });

            // === LEARNING DATA AND ANALYTICS ===
            const [learningData, setLearningData] = useState({
                userPatterns: {
                    javascript: { frequency: 15, preferences: { api: 5, frontend: 8 }, frameworks: { react: 12, vue: 3, angular: 2 } },
                    python: { frequency: 8, preferences: { backend: 4, ai: 3, data: 1 }, frameworks: { fastapi: 5, django: 2, flask: 1 } },
                    typescript: { frequency: 10, preferences: { frontend: 7, fullstack: 3 }, frameworks: { react: 8, next: 4, nest: 2 } },
                    rust: { frequency: 3, preferences: { systems: 2, performance: 1 }, frameworks: { actix: 1, warp: 1 } },
                    go: { frequency: 5, preferences: { backend: 3, microservices: 2 }, frameworks: { gin: 2, fiber: 1 } }
                },
                codeSnippets: {},
                successfulSolutions: [
                    { query: 'React component with hooks', language: 'javascript', timestamp: new Date(), rating: 5 },
                    { query: 'FastAPI backend with auth', language: 'python', timestamp: new Date(), rating: 4 },
                    { query: 'TypeScript interface design', language: 'typescript', timestamp: new Date(), rating: 5 }
                ],
                contextHistory: [],
                personalizedSuggestions: [
                    'Create a React component with TypeScript and tests',
                    'Build a FastAPI microservice with Docker deployment',
                    'Set up Next.js application with authentication',
                    'Generate comprehensive API documentation',
                    'Optimize React application for performance',
                    'Create secure authentication system',
                    'Build responsive UI component library',
                    'Set up CI/CD pipeline with testing'
                ],
                projectContext: {
                    currentProjects: ['E-commerce Platform', 'AI Dashboard', 'Mobile App API'],
                    technologies: ['React', 'TypeScript', 'Python', 'FastAPI', 'PostgreSQL', 'Docker'],
                    teamSize: 'medium',
                    experienceLevel: 'advanced'
                },
                performance: { 
                    accuracy: 95.2, 
                    speed: 98.1, 
                    satisfaction: 92.7,
                    efficiency: 89.4
                }
            });

            // === ANALYTICS DATA ===
            const [analyticsData, setAnalyticsData] = useState({
                totalQueries: 247,
                successRate: 94.6,
                avgResponseTime: 2.1,
                totalProcessingTime: 1247.3,
                modelUsage: {
                    'gpt-4-turbo': 89,
                    'claude-3-opus': 43,
                    'codex': 67,
                    'gemini-ultra': 28,
                    'dall-e-3': 15,
                    'whisper': 12,
                    'local-llama': 8
                },
                agentUsage: {
                    'searchAgent': 156,
                    'codeReviewer': 45,
                    'testGenerator': 38,
                    'securityAnalyst': 23,
                    'optimizationEngine': 31,
                    'documentationBot': 19
                },
                userSatisfaction: 4.8,
                costEfficiency: 91.2,
                performanceMetrics: {
                    accuracy: 94.8,
                    speed: 89.3,
                    reliability: 96.1,
                    innovation: 91.7,
                    userExperience: 93.2
                },
                weeklyStats: [
                    { day: 'Mon', queries: 42, success: 96, avgTime: 2.3 },
                    { day: 'Tue', queries: 38, success: 94, avgTime: 2.0 },
                    { day: 'Wed', queries: 45, success: 92, avgTime: 2.4 },
                    { day: 'Thu', queries: 41, success: 95, avgTime: 1.9 },
                    { day: 'Fri', queries: 47, success: 97, avgTime: 2.1 },
                    { day: 'Sat', queries: 23, success: 91, avgTime: 2.8 },
                    { day: 'Sun', queries: 18, success: 93, avgTime: 2.5 }
                ],
                topQueries: [
                    { query: 'React component generation', count: 23 },
                    { query: 'API design patterns', count: 18 },
                    { query: 'Code optimization', count: 15 },
                    { query: 'TypeScript interfaces', count: 12 },
                    { query: 'Testing strategies', count: 11 }
                ]
            });

            // === CONNECTED TOOLS ===
            const [connectedTools, setConnectedTools] = useState({
                github: { connected: true, status: 'active', lastSync: new Date() },
                docker: { connected: false, status: 'inactive', lastSync: null },
                aws: { connected: false, status: 'inactive', lastSync: null },
                vscode: { connected: true, status: 'active', lastSync: new Date() },
                figma: { connected: false, status: 'inactive', lastSync: null },
                slack: { connected: true, status: 'active', lastSync: new Date() },
                jira: { connected: false, status: 'inactive', lastSync: null },
                notion: { connected: true, status: 'active', lastSync: new Date() }
            });

            // === CODE TEMPLATES ===
            const codeTemplates = {
                react: {
                    component: `import React, { useState, useEffect, useCallback, useMemo } from 'react';

interface Props {
  title: string;
  data: any[];
  onItemClick?: (item: any) => void;
  onItemSelect?: (items: any[]) => void;
  loading?: boolean;
  className?: string;
  enableSearch?: boolean;
  enableSort?: boolean;
  enableMultiSelect?: boolean;
  pageSize?: number;
}

interface SortConfig {
  key: string;
  direction: 'asc' | 'desc';
}

const GeneratedComponent: React.FC<Props> = ({ 
  title, 
  data, 
  onItemClick, 
  onItemSelect,
  loading = false,
  className = '',
  enableSearch = true,
  enableSort = true,
  enableMultiSelect = false,
  pageSize = 10
}) => {
  const [searchTerm, setSearchTerm] = useState('');
  const [sortConfig, setSortConfig] = useState<SortConfig | null>(null);
  const [selectedItems, setSelectedItems] = useState<any[]>([]);
  const [currentPage, setCurrentPage] = useState(1);

  // Memoized search and sort functionality
  const processedData = useMemo(() => {
    let result = [...data];

    // Apply search filter
    if (searchTerm && enableSearch) {
      result = result.filter(item => 
        JSON.stringify(item).toLowerCase().includes(searchTerm.toLowerCase())
      );
    }

    // Apply sorting
    if (sortConfig && enableSort) {
      result.sort((a, b) => {
        const aValue = a[sortConfig.key];
        const bValue = b[sortConfig.key];
        
        if (aValue < bValue) return sortConfig.direction === 'asc' ? -1 : 1;
        if (aValue > bValue) return sortConfig.direction === 'asc' ? 1 : -1;
        return 0;
      });
    }

    return result;
  }, [data, searchTerm, sortConfig, enableSearch, enableSort]);

  // Pagination
  const paginatedData = useMemo(() => {
    const startIndex = (currentPage - 1) * pageSize;
    return processedData.slice(startIndex, startIndex + pageSize);
  }, [processedData, currentPage, pageSize]);

  const totalPages = Math.ceil(processedData.length / pageSize);

  const handleItemClick = useCallback((item: any) => {
    if (enableMultiSelect) {
      const newSelected = selectedItems.includes(item)
        ? selectedItems.filter(selected => selected !== item)
        : [...selectedItems, item];
      
      setSelectedItems(newSelected);
      onItemSelect?.(newSelected);
    }
    
    onItemClick?.(item);
  }, [onItemClick, onItemSelect, selectedItems, enableMultiSelect]);

  if (loading) {
    return (
      <div className={\`flex justify-center items-center p-8 \${className}\`}>
        <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"></div>
        <span className="ml-2 text-gray-600">Loading...</span>
      </div>
    );
  }

  return (
    <div className={\`p-6 bg-white rounded-lg shadow-md \${className}\`}>
      <div className="flex justify-between items-center mb-4">
        <h2 className="text-2xl font-bold">{title}</h2>
        {enableMultiSelect && selectedItems.length > 0 && (
          <div className="text-sm text-gray-600">
            {selectedItems.length} item(s) selected
          </div>
        )}
      </div>
      
      {enableSearch && (
        <div className="mb-4">
          <input
            type="text"
            placeholder="Search..."
            value={searchTerm}
            onChange={(e) => setSearchTerm(e.target.value)}
            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
        </div>
      )}

      <div className="space-y-2">
        {paginatedData.length === 0 ? (
          <p className="text-center text-gray-500 py-8">No items found</p>
        ) : (
          paginatedData.map((item, index) => (
            <div
              key={index}
              onClick={() => handleItemClick(item)}
              className={\`p-4 border rounded-lg cursor-pointer transition-colors hover:bg-gray-50 \${
                selectedItems.includes(item) ? 'bg-blue-50 border-blue-300' : 'border-gray-200'
              }\`}
            >
              <div className="flex items-center justify-between">
                <div className="flex-1">
                  {Object.entries(item).map(([key, value]) => (
                    <div key={key} className="text-sm">
                      <span className="font-medium capitalize">{key}:</span> {String(value)}
                    </div>
                  ))}
                </div>
                {enableMultiSelect && (
                  <input
                    type="checkbox"
                    checked={selectedItems.includes(item)}
                    onChange={() => handleItemClick(item)}
                    className="ml-2"
                    onClick={(e) => e.stopPropagation()}
                  />
                )}
              </div>
            </div>
          ))
        )}
      </div>
      
      {/* Pagination */}
      {totalPages > 1 && (
        <div className="mt-4 flex items-center justify-between">
          <div className="text-sm text-gray-600">
            Showing {((currentPage - 1) * pageSize) + 1} to {Math.min(currentPage * pageSize, processedData.length)} of {processedData.length} items
          </div>
          <div className="flex items-center gap-2">
            <button
              onClick={() => setCurrentPage(prev => Math.max(1, prev - 1))}
              disabled={currentPage === 1}
              className="px-3 py-1 border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50"
            >
              Previous
            </button>
            <span className="text-sm text-gray-600">
              Page {currentPage} of {totalPages}
            </span>
            <button
              onClick={() => setCurrentPage(prev => Math.min(totalPages, prev + 1))}
              disabled={currentPage === totalPages}
              className="px-3 py-1 border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50"
            >
              Next
            </button>
          </div>
        </div>
      )}
    </div>
  );
};

export default GeneratedComponent;`,

                    hook: `import { useState, useEffect, useCallback, useRef } from 'react';

interface UseApiOptions {
  url: string;
  method?: 'GET' | 'POST' | 'PUT' | 'DELETE' | 'PATCH';
  headers?: Record<string, string>;
  autoFetch?: boolean;
  retries?: number;
  timeout?: number;
  cacheTime?: number;
  retryDelay?: number;
}

interface ApiState<T> {
  data: T | null;
  loading: boolean;
  error: string | null;
  status: number | null;
  lastFetch: Date | null;
}

export const useApi = <T = any>(options: UseApiOptions) => {
  const [state, setState] = useState<ApiState<T>>({
    data: null,
    loading: false,
    error: null,
    status: null,
    lastFetch: null,
  });

  const abortControllerRef = useRef<AbortController | null>(null);
  const retryCountRef = useRef(0);

  const fetchData = useCallback(async (body?: any, customOptions?: Partial<UseApiOptions>) => {
    const mergedOptions = { ...options, ...customOptions };
    
    // Cancel previous request
    if (abortControllerRef.current) {
      abortControllerRef.current.abort();
    }
    
    abortControllerRef.current = new AbortController();
    setState(prev => ({ ...prev, loading: true, error: null }));
    
    try {
      const response = await fetch(mergedOptions.url, {
        method: mergedOptions.method || 'GET',
        headers: {
          'Content-Type': 'application/json',
          ...mergedOptions.headers,
        },
        body: body ? JSON.stringify(body) : undefined,
        signal: abortControllerRef.current.signal,
      });

      if (!response.ok) {
        throw new Error(\`HTTP error! status: \${response.status}\`);
      }

      const data = await response.json();
      
      setState({ 
        data, 
        loading: false, 
        error: null, 
        status: response.status,
        lastFetch: new Date(),
      });
      
      retryCountRef.current = 0;
      return data;
      
    } catch (error) {
      const errorMessage = error instanceof Error ? error.message : 'Unknown error';
      
      setState(prev => ({
        ...prev,
        loading: false,
        error: errorMessage,
        status: null
      }));
      
      throw error;
    }
  }, [options]);

  // Auto-fetch on mount for GET requests
  useEffect(() => {
    if (options.autoFetch !== false && (options.method === 'GET' || !options.method)) {
      fetchData();
    }
    
    return () => {
      if (abortControllerRef.current) {
        abortControllerRef.current.abort();
      }
    };
  }, [fetchData, options.autoFetch, options.method]);

  const refetch = useCallback((customOptions?: Partial<UseApiOptions>) => {
    retryCountRef.current = 0;
    return fetchData(undefined, customOptions);
  }, [fetchData]);

  const mutate = useCallback((body: any, customOptions?: Partial<UseApiOptions>) => {
    retryCountRef.current = 0;
    return fetchData(body, { method: 'POST', ...customOptions });
  }, [fetchData]);

  return { 
    ...state, 
    refetch, 
    mutate,
    isLoading: state.loading,
    isError: !!state.error,
    isSuccess: !state.loading && !state.error && state.data !== null,
  };
};`
                },

                python: {
                    fastapi: `from fastapi import FastAPI, HTTPException, Depends, status
from fastapi.security import HTTPBearer, HTTPAuthorizationCredentials
from fastapi.middleware.cors import CORSMiddleware
from pydantic import BaseModel, Field, validator
from typing import Optional, List
from datetime import datetime, timedelta
import jwt
import bcrypt

app = FastAPI(title="Generated API", version="1.0.0")

# Add CORS middleware
app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

# Security
security = HTTPBearer()
SECRET_KEY = "your-secret-key-change-in-production"
ALGORITHM = "HS256"

# Models
class UserBase(BaseModel):
    email: str = Field(..., regex=r'^[\\w\\.-]+@[\\w\\.-]+\\.\\w+$')
    username: str = Field(..., min_length=3, max_length=50)
    full_name: Optional[str] = None

class UserCreate(UserBase):
    password: str = Field(..., min_length=8)

class User(UserBase):
    id: int
    is_active: bool = True
    created_at: datetime

class Token(BaseModel):
    access_token: str
    token_type: str

# Utility functions
def hash_password(password: str) -> str:
    return bcrypt.hashpw(password.encode('utf-8'), bcrypt.gensalt()).decode('utf-8')

def verify_password(password: str, hashed: str) -> bool:
    return bcrypt.checkpw(password.encode('utf-8'), hashed.encode('utf-8'))

def create_access_token(data: dict, expires_delta: Optional[timedelta] = None):
    to_encode = data.copy()
    if expires_delta:
        expire = datetime.utcnow() + expires_delta
    else:
        expire = datetime.utcnow() + timedelta(minutes=30)
    to_encode.update({"exp": expire})
    return jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)

# Routes
@app.get("/")
async def root():
    return {"message": "FastAPI is running!", "timestamp": datetime.utcnow()}

@app.get("/health")
async def health_check():
    return {"status": "healthy", "timestamp": datetime.utcnow()}

@app.post("/auth/register", response_model=dict)
async def register(user: UserCreate):
    # In production, save to database
    hashed_password = hash_password(user.password)
    return {
        "message": "User created successfully",
        "user": {"username": user.username, "email": user.email}
    }

@app.post("/auth/login", response_model=Token)
async def login(username: str, password: str):
    # In production, validate against database
    if username == "admin" and password == "password":
        access_token = create_access_token(data={"sub": username})
        return {"access_token": access_token, "token_type": "bearer"}
    raise HTTPException(status_code=401, detail="Invalid credentials")

@app.get("/users/me")
async def get_current_user(credentials: HTTPAuthorizationCredentials = Depends(security)):
    # In production, decode JWT and get user from database
    return {"username": "current_user", "email": "user@example.com"}

if __name__ == "__main__":
    import uvicorn
    uvicorn.run(app, host="0.0.0.0", port=8000)`,

                    dataclass: `from dataclasses import dataclass, field
from typing import List, Dict, Optional, Any
from datetime import datetime
from enum import Enum
import json
import uuid

class UserRole(Enum):
    ADMIN = "admin"
    USER = "user"
    MODERATOR = "moderator"

class Status(Enum):
    ACTIVE = "active"
    INACTIVE = "inactive"
    PENDING = "pending"

@dataclass
class BaseModel:
    id: str = field(default_factory=lambda: str(uuid.uuid4()))
    created_at: datetime = field(default_factory=datetime.utcnow)
    updated_at: datetime = field(default_factory=datetime.utcnow)
    
    def to_dict(self) -> Dict[str, Any]:
        """Convert to dictionary"""
        result = {}
        for key, value in self.__dict__.items():
            if isinstance(value, datetime):
                result[key] = value.isoformat()
            elif isinstance(value, Enum):
                result[key] = value.value
            elif hasattr(value, 'to_dict'):
                result[key] = value.to_dict()
            else:
                result[key] = value
        return result
    
    def to_json(self) -> str:
        """Convert to JSON string"""
        return json.dumps(self.to_dict(), indent=2)

@dataclass
class User(BaseModel):
    username: str
    email: str
    full_name: Optional[str] = None
    role: UserRole = UserRole.USER
    status: Status = Status.PENDING
    tags: List[str] = field(default_factory=list)
    metadata: Dict[str, Any] = field(default_factory=dict)
    last_login: Optional[datetime] = None
    
    def __post_init__(self):
        self.validate()
    
    def validate(self):
        """Validate user data"""
        if len(self.username) < 3:
            raise ValueError("Username must be at least 3 characters")
        if "@" not in self.email:
            raise ValueError("Invalid email format")
    
    @property
    def display_name(self) -> str:
        return self.full_name or self.username
    
    @property
    def is_active(self) -> bool:
        return self.status == Status.ACTIVE
    
    def activate(self):
        """Activate user"""
        self.status = Status.ACTIVE
        self.updated_at = datetime.utcnow()
    
    def add_tag(self, tag: str):
        """Add tag to user"""
        if tag not in self.tags:
            self.tags.append(tag)
            self.updated_at = datetime.utcnow()`
                },

                javascript: {
                    express: `const express = require('express');
const helmet = require('helmet');
const cors = require('cors');
const rateLimit = require('express-rate-limit');
const { body, validationResult } = require('express-validator');
const bcrypt = require('bcrypt');
const jwt = require('jsonwebtoken');

const app = express();
const PORT = process.env.PORT || 3000;
const JWT_SECRET = process.env.JWT_SECRET || 'your-secret-key';

// Security middleware
app.use(helmet());
app.use(cors());
app.use(express.json());

// Rate limiting
const limiter = rateLimit({
    windowMs: 15 * 60 * 1000, // 15 minutes
    max: 100
});
app.use(limiter);

// Mock database
const users = [];

// Utility functions
const hashPassword = async (password) => {
    return await bcrypt.hash(password, 12);
};

const generateToken = (userId) => {
    return jwt.sign({ userId }, JWT_SECRET, { expiresIn: '24h' });
};

// Routes
app.get('/', (req, res) => {
    res.json({ message: 'Express API is running!' });
});

app.post('/auth/register', [
    body('email').isEmail(),
    body('password').isLength({ min: 8 }),
    body('username').isLength({ min: 3 })
], async (req, res) => {
    const errors = validationResult(req);
    if (!errors.isEmpty()) {
        return res.status(400).json({ errors: errors.array() });
    }

    const { email, password, username } = req.body;
    const hashedPassword = await hashPassword(password);
    
    const user = {
        id: Date.now(),
        email,
        username,
        password: hashedPassword,
        createdAt: new Date()
    };
    
    users.push(user);
    res.status(201).json({ message: 'User created', userId: user.id });
});

app.listen(PORT, () => {
    console.log(\`Server running on port \${PORT}\`);
});`
                }
            };
// === UTILITY FUNCTIONS ===
            
            // Language and Framework Detection
            const detectLanguage = (query) => {
                const langKeywords = {
                    javascript: ['js', 'javascript', 'node', 'npm', 'yarn', 'webpack', 'babel', 'react', 'vue', 'angular'],
                    typescript: ['typescript', 'ts', 'interface', 'type', 'generic', 'enum'],
                    python: ['python', 'py', 'pip', 'conda', 'django', 'flask', 'fastapi', 'pandas', 'numpy'],
                    java: ['java', 'spring', 'maven', 'gradle', 'hibernate', 'jvm'],
                    cpp: ['c++', 'cpp', 'std::', 'iostream', 'vector', 'template'],
                    rust: ['rust', 'cargo', 'fn', 'mut', 'impl', 'trait', 'struct'],
                    go: ['golang', 'go', 'func', 'package', 'import', 'goroutine'],
                    php: ['php', 'laravel', 'symfony', 'composer'],
                    ruby: ['ruby', 'rails', 'gem', 'bundle'],
                    swift: ['swift', 'ios', 'xcode', 'cocoapods'],
                    kotlin: ['kotlin', 'android', 'gradle'],
                    csharp: ['c#', 'csharp', '.net', 'nuget', 'asp.net'],
                    sql: ['sql', 'mysql', 'postgresql', 'sqlite', 'database', 'query'],
                    html: ['html', 'css', 'scss', 'sass', 'tailwind'],
                    shell: ['bash', 'shell', 'zsh', 'terminal', 'cli', 'script']
                };

                const queryLower = query.toLowerCase();
                for (const [lang, keywords] of Object.entries(langKeywords)) {
                    if (keywords.some(keyword => queryLower.includes(keyword))) {
                        return lang;
                    }
                }
                return 'general';
            };

            const detectFramework = (query) => {
                const frameworks = {
                    react: ['react', 'jsx', 'component', 'useState', 'useEffect', 'props'],
                    vue: ['vue', 'vuejs', 'composition api', 'reactive', 'ref'],
                    angular: ['angular', 'component', 'service', 'module', 'directive'],
                    svelte: ['svelte', 'sveltekit', 'stores'],
                    nextjs: ['next.js', 'nextjs', 'pages', 'api routes'],
                    nuxtjs: ['nuxt', 'nuxtjs', 'pages', 'plugins'],
                    express: ['express', 'middleware', 'router'],
                    fastapi: ['fastapi', 'pydantic', 'async def'],
                    django: ['django', 'models', 'views', 'urls'],
                    flask: ['flask', 'app.route', 'blueprint'],
                    spring: ['spring', 'boot', 'mvc', 'data'],
                    laravel: ['laravel', 'eloquent', 'artisan'],
                    rails: ['rails', 'activerecord', 'mvc'],
                    dotnet: ['.net', 'asp.net', 'core', 'mvc']
                };

                const queryLower = query.toLowerCase();
                for (const [framework, keywords] of Object.entries(frameworks)) {
                    if (keywords.some(keyword => queryLower.includes(keyword))) {
                        return framework;
                    }
                }
                return null;
            };

            const detectProblemType = (query) => {
                const problemTypes = {
                    'algorithm': ['sort', 'search', 'algorithm', 'optimize', 'performance', 'complexity'],
                    'debug': ['error', 'bug', 'debug', 'fix', 'not working', 'issue', 'problem'],
                    'api': ['api', 'fetch', 'request', 'endpoint', 'rest', 'graphql', 'webhook'],
                    'database': ['database', 'sql', 'query', 'table', 'schema', 'migration'],
                    'frontend': ['ui', 'interface', 'styling', 'css', 'html', 'component', 'responsive'],
                    'backend': ['server', 'backend', 'middleware', 'authentication', 'security'],
                    'testing': ['test', 'unit test', 'integration', 'mock', 'jest', 'pyte